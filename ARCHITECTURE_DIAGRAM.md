## ğŸ—ï¸ BACKEND API ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FLUTTER ADMIN APP                          â”‚
â”‚                   (http://localhost:3001)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP Requests + Bearer Token
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CORS MIDDLEWARE                          â”‚
â”‚              (Allows: localhost:3000, 3001, *)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LARAVEL API ROUTES                         â”‚
â”‚                   (routes/api.php)                              â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“ /api/admin/login (PUBLIC)                                   â”‚
â”‚  â”œâ”€â”€ AdminAuthController@login                                  â”‚
â”‚  â”‚                                                              â”‚
â”‚  ğŸ“ /api/admin/* (PROTECTED)                                    â”‚
â”‚  â”œâ”€â”€ Middleware: auth:sanctum + admin                          â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ /logout â†’ AdminAuthController@logout                      â”‚
â”‚  â”œâ”€â”€ /me â†’ AdminAuthController@me                              â”‚
â”‚  â”œâ”€â”€ /users â†’ AdminApiController (CRUD)                        â”‚
â”‚  â”œâ”€â”€ /products â†’ AdminProductApiController (CRUD)              â”‚
â”‚  â”œâ”€â”€ /statistics â†’ AdminApiController@statistics               â”‚
â”‚  â”œâ”€â”€ /orders â†’ AdminApiController (Orders)                     â”‚
â”‚  â”œâ”€â”€ /virtual-tours â†’ AdminVirtualTourApiController            â”‚
â”‚  â””â”€â”€ /contents â†’ AdminContentApiController                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SANCTUM MIDDLEWARE                           â”‚
â”‚                  (auth:sanctum)                                 â”‚
â”‚                                                                  â”‚
â”‚  1. Checks Authorization: Bearer {token}                        â”‚
â”‚  2. Validates token in personal_access_tokens table             â”‚
â”‚  3. Loads authenticated user                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ADMIN MIDDLEWARE                             â”‚
â”‚              (app/Http/Middleware/AdminMiddleware.php)          â”‚
â”‚                                                                  â”‚
â”‚  1. Checks if user is authenticated                             â”‚
â”‚  2. Verifies user->role === 'admin'                            â”‚
â”‚  3. Returns 403 if not admin                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CONTROLLERS                               â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AdminAuthController                                      â”‚  â”‚
â”‚  â”‚  â€¢ login()    - Create token                             â”‚  â”‚
â”‚  â”‚  â€¢ logout()   - Delete token                             â”‚  â”‚
â”‚  â”‚  â€¢ me()       - Get profile                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AdminApiController (Users + Dashboard)                   â”‚  â”‚
â”‚  â”‚  â€¢ index()       - List users (search, filter, paginate) â”‚  â”‚
â”‚  â”‚  â€¢ store()       - Create user                           â”‚  â”‚
â”‚  â”‚  â€¢ show()        - Get user detail                       â”‚  â”‚
â”‚  â”‚  â€¢ update()      - Update user                           â”‚  â”‚
â”‚  â”‚  â€¢ destroy()     - Delete user                           â”‚  â”‚
â”‚  â”‚  â€¢ statistics()  - Dashboard stats                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AdminProductApiController                                â”‚  â”‚
â”‚  â”‚  â€¢ index()       - List products                         â”‚  â”‚
â”‚  â”‚  â€¢ store()       - Create product                        â”‚  â”‚
â”‚  â”‚  â€¢ show()        - Get product detail                    â”‚  â”‚
â”‚  â”‚  â€¢ update()      - Update product                        â”‚  â”‚
â”‚  â”‚  â€¢ destroy()     - Delete product                        â”‚  â”‚
â”‚  â”‚  â€¢ uploadImage() - Upload product image                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          MODELS                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚    User      â”‚  â”‚   Kuliner    â”‚  â”‚   Pesanan    â”‚         â”‚
â”‚  â”‚              â”‚  â”‚  (Product)   â”‚  â”‚   (Order)    â”‚         â”‚
â”‚  â”‚ â€¢ id         â”‚  â”‚ â€¢ id         â”‚  â”‚ â€¢ id         â”‚         â”‚
â”‚  â”‚ â€¢ name       â”‚  â”‚ â€¢ title      â”‚  â”‚ â€¢ nomor      â”‚         â”‚
â”‚  â”‚ â€¢ email      â”‚  â”‚ â€¢ text       â”‚  â”‚ â€¢ user_id    â”‚         â”‚
â”‚  â”‚ â€¢ password   â”‚  â”‚ â€¢ price      â”‚  â”‚ â€¢ total      â”‚         â”‚
â”‚  â”‚ â€¢ role       â”‚  â”‚ â€¢ image      â”‚  â”‚ â€¢ status     â”‚         â”‚
â”‚  â”‚ â€¢ phone      â”‚  â”‚ â€¢ alamat     â”‚  â”‚ â€¢ items      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MYSQL DATABASE                             â”‚
â”‚                    (wisatalembung)                              â”‚
â”‚                                                                  â”‚
â”‚  Tables:                                                        â”‚
â”‚  â€¢ users                                                        â”‚
â”‚  â€¢ kuliners (products)                                          â”‚
â”‚  â€¢ pesanans (orders)                                            â”‚
â”‚  â€¢ personal_access_tokens (Sanctum)                             â”‚
â”‚  â€¢ virtual_tours                                                â”‚
â”‚  â€¢ kontens (content)                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ REQUEST FLOW

### 1ï¸âƒ£ Login Flow
```
Flutter App
    â”‚
    â”œâ”€â”€ POST /api/admin/login
    â”‚   Body: { email, password, device_name }
    â”‚
    â–¼
AdminAuthController@login
    â”‚
    â”œâ”€â”€ Validate credentials
    â”œâ”€â”€ Check role === 'admin'
    â”œâ”€â”€ Create Sanctum token
    â”‚
    â–¼
Response: { success: true, data: { user, token } }
    â”‚
    â–¼
Flutter App saves token
```

### 2ï¸âƒ£ Protected Request Flow
```
Flutter App
    â”‚
    â”œâ”€â”€ GET /api/admin/users
    â”‚   Headers: { Authorization: Bearer {token} }
    â”‚
    â–¼
Sanctum Middleware
    â”‚
    â”œâ”€â”€ Validate token
    â”œâ”€â”€ Load user
    â”‚
    â–¼
Admin Middleware
    â”‚
    â”œâ”€â”€ Check user.role === 'admin'
    â”‚
    â–¼
AdminApiController@index
    â”‚
    â”œâ”€â”€ Apply search filter
    â”œâ”€â”€ Apply role filter
    â”œâ”€â”€ Paginate results
    â”‚
    â–¼
Response: { success: true, data: [...], pagination }
    â”‚
    â–¼
Flutter App displays users
```

### 3ï¸âƒ£ Dashboard Stats Flow
```
Flutter App
    â”‚
    â”œâ”€â”€ GET /api/admin/statistics
    â”‚   Headers: { Authorization: Bearer {token} }
    â”‚
    â–¼
AdminApiController@statistics
    â”‚
    â”œâ”€â”€ Count users (total, admins)
    â”œâ”€â”€ Get recent users (last 5)
    â”œâ”€â”€ Count products
    â”œâ”€â”€ Calculate product stats (avg, min, max price)
    â”œâ”€â”€ Get recent products (last 5)
    â”œâ”€â”€ Count orders by status
    â”œâ”€â”€ Calculate revenue (month, total)
    â”œâ”€â”€ Generate monthly revenue chart (6 months)
    â”‚
    â–¼
Response: { success: true, data: { users, products, orders, revenue, charts } }
    â”‚
    â–¼
Flutter App displays dashboard
```

---

## ğŸ›¡ï¸ SECURITY LAYERS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: CORS - Prevents unauthorized origins                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: Sanctum - Token authentication                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: Admin Middleware - Role verification                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: Controller Validation - Input validation             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 5: Model - Database constraints                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š DATA FLOW DIAGRAM

### User Management
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flutter App  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ GET /api/admin/users?search=john&role=user
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AdminApiController@index                 â”‚
â”‚                                          â”‚
â”‚  $query = User::select(...)              â”‚
â”‚                                          â”‚
â”‚  if ($search) {                          â”‚
â”‚    $query->where('name', 'LIKE', ...)    â”‚
â”‚  }                                       â”‚
â”‚                                          â”‚
â”‚  if ($role) {                            â”‚
â”‚    $query->where('role', $role)          â”‚
â”‚  }                                       â”‚
â”‚                                          â”‚
â”‚  $users = $query->paginate($perPage)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response Format:                         â”‚
â”‚                                          â”‚
â”‚ {                                        â”‚
â”‚   "success": true,                       â”‚
â”‚   "data": [...],                         â”‚
â”‚   "current_page": 1,                     â”‚
â”‚   "last_page": 5,                        â”‚
â”‚   "per_page": 10,                        â”‚
â”‚   "total": 45                            â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flutter UI   â”‚
â”‚ Displays     â”‚
â”‚ User List    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Product Management
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flutter App  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ POST /api/admin/products
       â”‚ Body: FormData (multipart/form-data)
       â”‚ - title
       â”‚ - text
       â”‚ - price
       â”‚ - image (file)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AdminProductApiController@store          â”‚
â”‚                                          â”‚
â”‚  Validate input                          â”‚
â”‚  Handle image upload                     â”‚
â”‚  Save to storage/kuliners/               â”‚
â”‚  Create Kuliner record                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Storage                                  â”‚
â”‚ storage/app/public/kuliners/             â”‚
â”‚   â””â”€â”€ {timestamp}_{slug}.jpg             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database                                 â”‚
â”‚ kuliners table                           â”‚
â”‚   â””â”€â”€ image: {filename}                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response     â”‚
â”‚ Product      â”‚
â”‚ Created      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ TOKEN LIFECYCLE

```
1. LOGIN
   POST /api/admin/login
   â†“
   Create token in personal_access_tokens table
   â†“
   Return token to client

2. USAGE
   GET /api/admin/users
   Headers: Authorization: Bearer {token}
   â†“
   Sanctum validates token
   â†“
   Loads user
   â†“
   Admin middleware checks role
   â†“
   Controller processes request

3. LOGOUT
   POST /api/admin/logout
   â†“
   Delete token from personal_access_tokens
   â†“
   Token invalidated
```

---

## ğŸ“¦ FILE STRUCTURE

```
wisatalembung/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ Http/
â”‚   â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”‚   â””â”€â”€ Api/
â”‚   â”‚   â”‚       â”œâ”€â”€ AdminAuthController.php       â­
â”‚   â”‚   â”‚       â”œâ”€â”€ AdminApiController.php        â­ Enhanced
â”‚   â”‚   â”‚       â”œâ”€â”€ AdminProductApiController.php â­
â”‚   â”‚   â”‚       â”œâ”€â”€ AdminVirtualTourApiController.php
â”‚   â”‚   â”‚       â””â”€â”€ AdminContentApiController.php
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Middleware/
â”‚   â”‚   â”‚   â””â”€â”€ AdminMiddleware.php               â­
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Kernel.php                            â­ Updated
â”‚   â”‚
â”‚   â””â”€â”€ Models/
â”‚       â”œâ”€â”€ User.php                              â­ HasApiTokens
â”‚       â”œâ”€â”€ Kuliner.php                           â­ Product model
â”‚       â””â”€â”€ Pesanan.php
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ sanctum.php                               â­ Configured
â”‚   â””â”€â”€ cors.php                                  â­ Configured
â”‚
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ api.php                                   â­ All routes
â”‚
â”œâ”€â”€ database/
â”‚   â””â”€â”€ migrations/
â”‚       â””â”€â”€ *_personal_access_tokens              â­ Sanctum
â”‚
â”œâ”€â”€ storage/
â”‚   â””â”€â”€ app/
â”‚       â””â”€â”€ public/
â”‚           â””â”€â”€ kuliners/                         ğŸ“ Product images
â”‚
â””â”€â”€ Documentation/
    â”œâ”€â”€ BACKEND_API_TESTING_GUIDE.md             ğŸ“˜ Testing
    â”œâ”€â”€ BACKEND_API_SETUP_SUMMARY.md             ğŸ“˜ Summary
    â”œâ”€â”€ BACKEND_SETUP_COMPLETE.md                ğŸ“˜ Report
    â”œâ”€â”€ QUICK_START_API.md                       ğŸ“˜ Quick start
    â”œâ”€â”€ test-login.ps1                           ğŸ§ª Test script
    â””â”€â”€ test-admin-api.ps1                       ğŸ§ª Full test
```

â­ = Modified/Enhanced  
ğŸ“ = Directory for uploads  
ğŸ“˜ = Documentation  
ğŸ§ª = Test script

---

**This architecture provides:**
- âœ… Secure authentication with Sanctum
- âœ… Role-based authorization
- âœ… RESTful API design
- âœ… Consistent response format
- âœ… Comprehensive error handling
- âœ… Search & filter capabilities
- âœ… File upload support
- âœ… Dashboard analytics
- âœ… Complete documentation
